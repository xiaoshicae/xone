<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1060 780" font-family="'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif">
  <defs>
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="112%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#00000020"/>
    </filter>
    <filter id="shadow-lg" x="-4%" y="-4%" width="108%" height="116%">
      <feDropShadow dx="0" dy="3" stdDeviation="5" flood-color="#00000028"/>
    </filter>
    <linearGradient id="bg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f8fafc"/>
      <stop offset="100%" stop-color="#e2e8f0"/>
    </linearGradient>
    <linearGradient id="g-app" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#6366f1"/>
      <stop offset="100%" stop-color="#4f46e5"/>
    </linearGradient>
    <linearGradient id="g-lifecycle" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#8b5cf6"/>
      <stop offset="100%" stop-color="#7c3aed"/>
    </linearGradient>
    <linearGradient id="g-service" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#14b8a6"/>
      <stop offset="100%" stop-color="#0d9488"/>
    </linearGradient>
    <linearGradient id="g-core" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f59e0b"/>
      <stop offset="100%" stop-color="#d97706"/>
    </linearGradient>
    <linearGradient id="g-found" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#64748b"/>
      <stop offset="100%" stop-color="#475569"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#94a3b8"/>
    </marker>
    <marker id="arrow-blue" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#818cf8"/>
    </marker>
    <marker id="arrow-yellow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#fbbf24"/>
    </marker>
  </defs>

  <!-- 背景 -->
  <rect width="1060" height="780" fill="url(#bg)" rx="12"/>

  <!-- 标题 -->
  <text x="420" y="42" text-anchor="middle" font-size="22" font-weight="700" fill="#1e293b">XOne 模块架构图</text>
  <text x="420" y="64" text-anchor="middle" font-size="13" fill="#64748b">Go 三方库集成框架 SDK &#8212; 模块依赖与生命周期</text>

  <!-- ====== 层级标签 ====== -->
  <text x="32" y="118" font-size="11" fill="#6366f1" font-weight="600" letter-spacing="1">APPLICATION</text>
  <text x="32" y="228" font-size="11" fill="#8b5cf6" font-weight="600" letter-spacing="1">LIFECYCLE</text>
  <text x="32" y="348" font-size="11" fill="#14b8a6" font-weight="600" letter-spacing="1">SERVICES</text>
  <text x="32" y="498" font-size="11" fill="#f59e0b" font-weight="600" letter-spacing="1">CORE</text>
  <text x="32" y="618" font-size="11" fill="#64748b" font-weight="600" letter-spacing="1">FOUNDATION</text>

  <!-- 层级分隔线 -->
  <line x1="30" y1="170" x2="830" y2="170" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="6,4"/>
  <line x1="30" y1="280" x2="830" y2="280" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="6,4"/>
  <line x1="30" y1="440" x2="830" y2="440" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="6,4"/>
  <line x1="30" y1="560" x2="830" y2="560" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="6,4"/>

  <!-- ====== APPLICATION 层 ====== -->
  <rect x="230" y="90" width="380" height="68" rx="10" fill="url(#g-app)" filter="url(#shadow-lg)"/>
  <text x="420" y="120" text-anchor="middle" font-size="18" font-weight="700" fill="white">xgin</text>
  <text x="420" y="142" text-anchor="middle" font-size="11" fill="#c7d2fe">Gin HTTP 服务器 &#183; Builder 模式 &#183; 内置中间件 &#183; Swagger</text>

  <!-- ====== LIFECYCLE 层 ====== -->
  <rect x="160" y="195" width="240" height="60" rx="10" fill="url(#g-lifecycle)" filter="url(#shadow)"/>
  <text x="280" y="222" text-anchor="middle" font-size="16" font-weight="700" fill="white">xserver</text>
  <text x="280" y="241" text-anchor="middle" font-size="10" fill="#ddd6fe">Server 接口 &#183; Run / Stop &#183; 信号处理</text>

  <rect x="440" y="195" width="240" height="60" rx="10" fill="url(#g-lifecycle)" filter="url(#shadow)"/>
  <text x="560" y="222" text-anchor="middle" font-size="16" font-weight="700" fill="white">xhook</text>
  <text x="560" y="241" text-anchor="middle" font-size="10" fill="#ddd6fe">BeforeStart / BeforeStop &#183; init() 注册</text>

  <!-- ====== SERVICES 层 ====== -->
  <rect x="60" y="305" width="230" height="60" rx="10" fill="url(#g-service)" filter="url(#shadow)"/>
  <text x="175" y="330" text-anchor="middle" font-size="15" font-weight="700" fill="white">xhttp</text>
  <text x="175" y="349" text-anchor="middle" font-size="10" fill="#99f6e4">go-resty &#183; Trace &#183; 重试</text>

  <rect x="310" y="305" width="230" height="60" rx="10" fill="url(#g-service)" filter="url(#shadow)"/>
  <text x="425" y="330" text-anchor="middle" font-size="15" font-weight="700" fill="white">xgorm</text>
  <text x="425" y="349" text-anchor="middle" font-size="10" fill="#99f6e4">GORM &#183; MySQL/PostgreSQL &#183; 多数据源</text>

  <rect x="560" y="305" width="230" height="60" rx="10" fill="url(#g-service)" filter="url(#shadow)"/>
  <text x="675" y="330" text-anchor="middle" font-size="15" font-weight="700" fill="white">xgin (config)</text>
  <text x="675" y="349" text-anchor="middle" font-size="10" fill="#99f6e4">Gin 配置 &#183; Swagger 配置</text>

  <!-- ====== CORE 层 ====== -->
  <rect x="60" y="465" width="230" height="60" rx="10" fill="url(#g-core)" filter="url(#shadow)"/>
  <text x="175" y="492" text-anchor="middle" font-size="16" font-weight="700" fill="white">xconfig</text>
  <text x="175" y="511" text-anchor="middle" font-size="10" fill="#fef3c7">Viper &#183; YAML &#183; Profile &#183; 环境变量</text>

  <rect x="310" y="465" width="230" height="60" rx="10" fill="url(#g-core)" filter="url(#shadow)"/>
  <text x="425" y="492" text-anchor="middle" font-size="16" font-weight="700" fill="white">xtrace</text>
  <text x="425" y="511" text-anchor="middle" font-size="10" fill="#fef3c7">OpenTelemetry &#183; W3C / B3</text>

  <rect x="560" y="465" width="230" height="60" rx="10" fill="url(#g-core)" filter="url(#shadow)"/>
  <text x="675" y="492" text-anchor="middle" font-size="16" font-weight="700" fill="white">xlog</text>
  <text x="675" y="511" text-anchor="middle" font-size="10" fill="#fef3c7">Logrus &#183; 文件轮转 &#183; KV 注入</text>

  <!-- ====== FOUNDATION 层 ====== -->
  <rect x="230" y="585" width="380" height="56" rx="10" fill="url(#g-found)" filter="url(#shadow)"/>
  <text x="420" y="610" text-anchor="middle" font-size="15" font-weight="700" fill="white">xutil</text>
  <text x="420" y="628" text-anchor="middle" font-size="10" fill="#cbd5e1">Duration &#183; Debug 日志 &#183; TraceID &#183; JSON &#183; 默认值</text>

  <!-- ====== 依赖箭头 ====== -->
  <!-- xgin → xserver (实现 Server 接口) -->
  <path d="M 350 158 L 300 195" fill="none" stroke="#818cf8" stroke-width="1.8" marker-end="url(#arrow-blue)"/>

  <!-- xserver → xhook (调用 hooks) -->
  <line x1="400" y1="225" x2="440" y2="225" stroke="#a78bfa" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- xhook → services (通过 init() 注册) -->
  <path d="M 560 255 L 560 278 L 175 278 L 175 305" fill="none" stroke="#94a3b8" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <path d="M 560 255 L 560 278 L 425 278 L 425 305" fill="none" stroke="#94a3b8" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>

  <!-- xhook → core 模块 (hook 注册) -->
  <path d="M 560 255 L 560 278 L 790 278 L 790 440 L 425 440 L 425 465" fill="none" stroke="#94a3b8" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <path d="M 790 440 L 675 440 L 675 465" fill="none" stroke="#94a3b8" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>

  <!-- services → xconfig (配置依赖) -->
  <path d="M 175 365 L 175 450 L 200 465" fill="none" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>
  <path d="M 425 365 L 425 430 L 260 465" fill="none" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>
  <path d="M 675 365 L 675 430 L 290 465" fill="none" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>

  <!-- xtrace → xconfig -->
  <line x1="370" y1="495" x2="290" y2="495" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>

  <!-- xlog → xconfig -->
  <line x1="620" y1="495" x2="540" y2="495" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>

  <!-- ====== 右侧：初始化顺序面板 ====== -->
  <rect x="860" y="82" width="180" height="520" rx="10" fill="white" fill-opacity="0.6" stroke="#e2e8f0" stroke-width="1"/>

  <!-- BeforeStart 标题 -->
  <text x="950" y="108" text-anchor="middle" font-size="12" font-weight="700" fill="#1e293b">BeforeStart</text>
  <text x="950" y="124" text-anchor="middle" font-size="11" fill="#64748b">初始化顺序</text>

  <!-- 初始化顺序列表 -->
  <g>
    <line x1="900" y1="155" x2="900" y2="350" stroke="#14b8a6" stroke-width="2" opacity="0.4"/>

    <circle cx="900" cy="155" r="14" fill="url(#g-core)"/>
    <text x="900" y="160" text-anchor="middle" font-size="10" font-weight="700" fill="white">1</text>
    <text x="922" y="160" font-size="12" font-weight="600" fill="#d97706">xconfig</text>

    <circle cx="900" cy="204" r="14" fill="url(#g-core)"/>
    <text x="900" y="209" text-anchor="middle" font-size="10" font-weight="700" fill="white">2</text>
    <text x="922" y="209" font-size="12" font-weight="600" fill="#d97706">xtrace</text>

    <circle cx="900" cy="253" r="14" fill="url(#g-core)"/>
    <text x="900" y="258" text-anchor="middle" font-size="10" font-weight="700" fill="white">3</text>
    <text x="922" y="258" font-size="12" font-weight="600" fill="#d97706">xlog</text>

    <circle cx="900" cy="302" r="14" fill="url(#g-service)"/>
    <text x="900" y="307" text-anchor="middle" font-size="10" font-weight="700" fill="white">4</text>
    <text x="922" y="307" font-size="12" font-weight="600" fill="#0d9488">xhttp</text>

    <circle cx="900" cy="351" r="14" fill="url(#g-service)"/>
    <text x="900" y="356" text-anchor="middle" font-size="10" font-weight="700" fill="white">5</text>
    <text x="922" y="356" font-size="12" font-weight="600" fill="#0d9488">xgorm</text>
  </g>

  <!-- BeforeStop 标题 -->
  <text x="950" y="410" text-anchor="middle" font-size="12" font-weight="700" fill="#1e293b">BeforeStop</text>
  <text x="950" y="426" text-anchor="middle" font-size="11" fill="#64748b">关闭顺序 (倒序)</text>

  <!-- 关闭顺序列表 -->
  <g>
    <line x1="900" y1="450" x2="900" y2="580" stroke="#f87171" stroke-width="2" opacity="0.4"/>

    <circle cx="900" cy="450" r="14" fill="#ef4444"/>
    <text x="900" y="455" text-anchor="middle" font-size="10" font-weight="700" fill="white">5</text>
    <text x="922" y="455" font-size="12" font-weight="600" fill="#dc2626">xgorm</text>

    <circle cx="900" cy="490" r="14" fill="#ef4444"/>
    <text x="900" y="495" text-anchor="middle" font-size="10" font-weight="700" fill="white">4</text>
    <text x="922" y="495" font-size="12" font-weight="600" fill="#dc2626">xhttp</text>

    <circle cx="900" cy="530" r="14" fill="#ef4444"/>
    <text x="900" y="535" text-anchor="middle" font-size="10" font-weight="700" fill="white">3</text>
    <text x="922" y="535" font-size="12" font-weight="600" fill="#dc2626">xlog</text>

    <circle cx="900" cy="570" r="14" fill="#ef4444"/>
    <text x="900" y="575" text-anchor="middle" font-size="10" font-weight="700" fill="white">2</text>
    <text x="922" y="575" font-size="12" font-weight="600" fill="#dc2626">xtrace</text>
  </g>

  <!-- ====== 图例 ====== -->
  <rect x="60" y="665" width="780" height="42" rx="8" fill="white" fill-opacity="0.7" stroke="#e2e8f0"/>
  <rect x="80" y="678" width="14" height="14" rx="3" fill="url(#g-app)"/>
  <text x="100" y="690" font-size="11" fill="#475569">应用层</text>
  <rect x="160" y="678" width="14" height="14" rx="3" fill="url(#g-lifecycle)"/>
  <text x="180" y="690" font-size="11" fill="#475569">生命周期</text>
  <rect x="260" y="678" width="14" height="14" rx="3" fill="url(#g-service)"/>
  <text x="280" y="690" font-size="11" fill="#475569">服务层</text>
  <rect x="340" y="678" width="14" height="14" rx="3" fill="url(#g-core)"/>
  <text x="360" y="690" font-size="11" fill="#475569">核心层</text>
  <rect x="420" y="678" width="14" height="14" rx="3" fill="url(#g-found)"/>
  <text x="440" y="690" font-size="11" fill="#475569">基础层</text>
  <!-- 箭头图例 -->
  <line x1="520" y1="685" x2="550" y2="685" stroke="#818cf8" stroke-width="1.8" marker-end="url(#arrow-blue)"/>
  <text x="558" y="690" font-size="11" fill="#475569">实现/调用</text>
  <line x1="630" y1="685" x2="660" y2="685" stroke="#94a3b8" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <text x="668" y="690" font-size="11" fill="#475569">Hook 注册</text>
  <line x1="745" y1="685" x2="775" y2="685" stroke="#fbbf24" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arrow-yellow)"/>
  <text x="783" y="690" font-size="11" fill="#475569">配置依赖</text>

  <!-- 底部说明 -->
  <text x="420" y="740" text-anchor="middle" font-size="11" fill="#94a3b8">所有 SERVICES/CORE 模块均依赖 xconfig 读取配置，依赖 xutil 工具函数</text>
  <text x="420" y="758" text-anchor="middle" font-size="11" fill="#94a3b8">模块之间无直接编译依赖，初始化顺序通过 Hook 注册顺序控制</text>
</svg>
